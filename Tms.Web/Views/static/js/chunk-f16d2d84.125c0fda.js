(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f16d2d84"],{"19da":function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mytable"},[a("b-container",{attrs:{fluid:""}},[a("b-row",[a("b-col",{staticClass:"my-1",attrs:{lg:"6"}},[a("b-form-group",{staticClass:"mb-0",attrs:{label:"字段搜索","label-cols-sm":"3","label-align-sm":"right","label-size":"sm","label-for":"filterInput"}},[a("b-input-group",{attrs:{size:"sm"}},[a("b-form-input",{attrs:{type:"search",placeholder:"名称/编号"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.userSearch()}},model:{value:t.pagination.keyword,callback:function(e){t.$set(t.pagination,"keyword","string"===typeof e?e.trim():e)},expression:"pagination.keyword"}}),t._v(" "),a("b-input-group-append",[t.searchFlag?a("b-button",{on:{click:this.clearKeyWord}},[t._v("\n                   清除\n                 ")]):a("b-button",{on:{click:this.userSearch}},[t._v("\n                   搜索\n                 ")])],1)],1)],1)],1),t._v(" "),a("b-col",{staticClass:"my-1",attrs:{sm:"5",md:"6"}},[a("b-form-group",{staticClass:"mb-0",attrs:{label:"每页数量","label-cols-sm":"6","label-cols-md":"4","label-cols-lg":"3","label-align-sm":"right","label-size":"sm","label-for":"perPageSelect"}},[a("b-form-select",{attrs:{size:"sm",options:t.pageOptions},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),a("b-col",{staticClass:"my-1",attrs:{sm:"5",md:"6"}}),t._v(" "),a("b-col",{staticClass:"my-1",attrs:{sm:"5",md:"6"}},[a("div",{staticClass:"mybutton-user"},[a("b-button",{staticClass:"mybutton-newuser",attrs:{size:"dm",variant:"primary"},on:{click:this.refresh}},[a("i",{staticClass:"el-icon-refresh"}),t._v("  刷新")]),t._v(" "),a("b-button",{staticClass:"mybutton-newuser",attrs:{size:"dm",variant:"primary"},on:{click:function(e){return t.insertRoleButton(e.target)}}},[a("i",{staticClass:"el-icon-plus"}),t._v("  新建岗位")]),t._v(" "),a("b-button",{attrs:{size:"dm",variant:"primary"},on:{click:function(e){return t.deleteRolesButton()}}},[a("i",{staticClass:"el-icon-delete"}),t._v("  删除岗位")])],1)])],1),t._v(" "),a("b-table",{attrs:{busy:t.spinFlag,striped:t.striped,bordered:t.bordered,"show-empty":"",small:"",stacked:"md",items:t.items,fields:t.fields,"sort-by":t.sortBy,"sort-direction":t.sortDirection,"sort-desc":t.sortDesc},on:{"update:sortBy":function(e){t.sortBy=e},"update:sort-by":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:sort-desc":function(e){t.sortDesc=e}},scopedSlots:t._u([{key:"table-busy",fn:function(){return[a("div",{staticClass:"text-center text-danger my-2"},[a("b-spinner",{staticClass:"align-middle"}),t._v(" "),a("strong",[t._v("加载中...")])],1)]},proxy:!0},{key:"cell(index)",fn:function(e){return[a("b-form-checkbox",{on:{change:function(a){return t.onRowSelected(e.item)}}},[t._v(" "+t._s(e.index+1)+" ")])]}},{key:"cell(actions)",fn:function(e){return[a("b-button",{staticClass:"mr-1",attrs:{size:"sm",name:"row.item.F_Id"},on:{click:function(a){return t.updataRoleButton(e.item,e.index,a.target)}}},[t._v("\n            修改\n          ")]),t._v(" "),a("b-button",{attrs:{size:"sm"},on:{click:e.toggleDetails}},[t._v("\n            "+t._s(e.detailsShowing?"关闭":"显示")+" 详情\n          ")]),t._v(" "),a("b-button",{staticClass:"mr-1",attrs:{size:"sm",name:"row.item.F_Id"},on:{click:function(a){return t.deleteRoleButton(e.item)}}},[t._v("\n            删除\n          ")])]}},{key:"row-details",fn:function(e){return[a("b-card",[a("ul",t._l(e.item,(function(e,l){return a("ul",{key:l},[t.fieldsName.get(l)?a("p",[t._v("\n                "+t._s(t.fieldsName.get(l))+" : "+t._s("归属机构"==t.fieldsName.get(l)?t.parentValue(e):"创建人员"==t.fieldsName.get(l)||"修改人员"==t.fieldsName.get(l)?t.nameValue(e):t.judgeValue(e))+"\n              ")]):t._e()])})),0)])]}}])}),t._v(" "),a("div",{staticClass:"myPage",attrs:{align:"center"}},[a("b-col",{staticClass:"my-1",attrs:{sm:"7",md:"6"}},[a("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage,align:"fill",size:"sm"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1),t._v(" "),a("b-modal",{attrs:{id:t.roleModel.id,title:t.roleModel.title,okTitle:"确定",cancelTitle:"取消","no-close-on-backdrop":!0,"no-close-on-esc":!0},on:{cancel:t.modalCancel,ok:t.modalOk},scopedSlots:t._u([{key:"modal-header",fn:function(e){return[a("h4",[t._v(t._s(t.roleModel.title))])]}}])},[t._v(" "),a("form",{ref:"form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[a("b-form-group",{attrs:{description:"",label:"归属部门:","label-for":"account","invalid-feedback":t.invalidParent,"label-cols-sm":"2",state:t.parentState}},[a("b-form-select",{attrs:{id:"parent",state:t.parentState,options:t.departmentList},model:{value:t.roleEntity.F_OrganizeId,callback:function(e){t.$set(t.roleEntity,"F_OrganizeId",e)},expression:"roleEntity.F_OrganizeId"}})],1),t._v(" "),a("b-form-group",{attrs:{description:"",label:"岗位名称:","label-for":"name","invalid-feedback":t.invalidName,"label-cols-sm":"2",state:t.nameState}},[a("b-form-input",{attrs:{id:"name",state:t.nameState,trim:""},model:{value:t.roleEntity.F_FullName,callback:function(e){t.$set(t.roleEntity,"F_FullName",e)},expression:"roleEntity.F_FullName"}})],1),t._v(" "),a("b-form-group",{attrs:{description:"",label:"岗位编号:","label-for":"code","invalid-feedback":t.invalidCode,"label-cols-sm":"2",state:t.codeState}},[a("b-form-input",{attrs:{id:"code",state:t.codeState,trim:""},model:{value:t.roleEntity.F_EnCode,callback:function(e){t.$set(t.roleEntity,"F_EnCode",e)},expression:"roleEntity.F_EnCode"}})],1),t._v(" "),a("b-form-group",{attrs:{"label-for":"allowEdit","label-cols-sm":"2",label:"允许编辑:","invalid-feedback":t.invalidEdit,state:t.allowEditmarkState}},[a("b-form-select",{attrs:{id:"allowEdit",state:t.allowEditmarkState,options:t.enabledList},model:{value:t.roleEntity.F_AllowEdit,callback:function(e){t.$set(t.roleEntity,"F_AllowEdit",e)},expression:"roleEntity.F_AllowEdit"}})],1),t._v(" "),a("b-form-group",{attrs:{"label-for":"allowDelete","label-cols-sm":"2",label:"允许删除:","invalid-feedback":t.invalidDelete,state:t.allowDeletemarkState}},[a("b-form-select",{attrs:{id:"allowDelete",state:t.allowDeletemarkState,options:t.enabledList},model:{value:t.roleEntity.F_AllowDelete,callback:function(e){t.$set(t.roleEntity,"F_AllowDelete",e)},expression:"roleEntity.F_AllowDelete"}})],1),t._v(" "),a("b-form-group",{attrs:{"label-for":"enabled","label-cols-sm":"2",label:"有效:","invalid-feedback":t.invalidEnable,state:t.enabledmarkState}},[a("b-form-select",{attrs:{id:"enabled",state:t.enabledmarkState,options:t.enabledList},model:{value:t.roleEntity.F_EnabledMark,callback:function(e){t.$set(t.roleEntity,"F_EnabledMark",e)},expression:"roleEntity.F_EnabledMark"}})],1),t._v(" "),a("b-form-group",{attrs:{description:"",label:"备注:","label-for":"desc","label-cols-sm":"2"}},[a("b-form-input",{attrs:{id:"phone",trim:""},model:{value:t.roleEntity.F_Description,callback:function(e){t.$set(t.roleEntity,"F_Description",e)},expression:"roleEntity.F_Description"}})],1)],1)])],1),t._v(" "),a("el-backtop",{attrs:{target:""}})],1)},n=[],i=(a("ac4d"),a("8a81"),a("ac6a"),a("5df3"),a("f400"),a("b775"));function s(t){return Object(i["a"])({url:"/SystemManage/Duty/GetGridListJson",method:"get",params:t})}function r(){return Object(i["a"])({url:"/SystemManage/Organize/GetGridJson",method:"get"})}function o(){return Object(i["a"])({url:"/SystemManage/User/GetAllUser",method:"get"})}function u(t){return Object(i["a"])({url:"/SystemManage/Duty/DeleteForm",method:"get",params:{keyValue:t}})}function c(t){return Object(i["a"])({url:"/SystemManage/Duty/BatchDeleteForm",method:"post",data:t})}function d(t){return Object(i["a"])({url:"/SystemManage/Duty/SubmitForm",method:"post",data:t})}function m(t,e){return Object(i["a"])({url:"/SystemManage/Duty/GetFormByParent",method:"get",params:{full_name:t,parentId:e}})}var f=a("5c96"),h={data:function(){var t=this;return{userUpdata:null,dutyList:[],roleList:[],departmentList:[],userList:[],mapLayer:null,mapDepartment:null,enabledList:[{text:"是",value:!0},{text:"否",value:!1}],parentStateFlag:null,nameStateFlag:null,codeStateFlag:null,allowEditmarkStateFlag:null,allowDeletemarkStateFlag:null,enabledmarkStateFlag:null,userF_OrganizeId:"",roleEntity:{F_OrganizeId:"",F_FullName:"",F_Category:2,F_EnCode:"",F_AllowEdit:null,F_AllowDelete:null,F_EnabledMark:null,F_CreatorUserId:"",F_CreatorTime:null,F_LastModifyUserId:"",F_LastModifyTime:null,F_Description:""},submitFormFlag:null,groupState:null,searchFlag:!1,totalRows:1,currentPage:1,perPage:10,pageOptions:[5,10,15,20,30],sortBy:null,sortDesc:!1,sortDirection:"asc",spinFlag:!0,pagination:{sord:"desc",page:1,rows:10,sidx:"F_CreatorTime",keyword:null},itemsSelected:[],roleMap:null,dutyMap:null,userMap:null,items:[],itemsBackUp:[],fieldsName:null,fields:[{key:"index",label:"序号"},{key:"F_FullName",label:"岗位名称",sortable:!0},{key:"F_EnCode",label:"岗位编号",sortable:!0},{key:"F_OrganizeId",label:"归属部门",sortable:!0,formatter:function(e,a,l){for(var n=0;n<t.departmentList.length;n++)if(t.departmentList[n].value==e)return t.departmentList[n].text}},{key:"F_CreatorTime",label:"创建时间",sortable:!0,sortByFormatted:!0,filterByFormatted:!0},{key:"F_EnabledMark",label:"有效",formatter:function(t,e,a){return t?"是":"否"}},{key:"F_Description",label:"备注"},{key:"actions",label:"操作"}],striped:!0,bordered:!0,roleModel:{id:"info-modal",title:"",content:""}}},watch:{perPage:function(){this.pagination.rows=this.perPage,this.getList()},currentPage:function(){this.pagination.page=this.currentPage,this.getList()},sortBy:function(){this.pagination.sidx=this.sortBy,this.getList(),Object(f["Message"])({message:"查询根据"+this.sortBy+"排序！",type:"success",duration:5e3})},sortDesc:function(){0==this.sortDesc?this.pagination.sord="asc":this.pagination.sord="desc",this.getList(),Object(f["Message"])({message:"查询根据"+this.sortBy+"的"+this.pagination.sord+"排序！",type:"success",duration:5e3})}},created:function(){this.setFieldsName(),this.getOrganizeList()},computed:{sortOptions:function(){return this.fields.filter((function(t){return t.sortable})).map((function(t){return{text:t.label,value:t.key}}))},parentState:function(){return this.parentStateFlag=""!=this.roleEntity.F_OrganizeId,this.parentStateFlag},nameState:function(){return this.nameStateFlag=""!=this.roleEntity.F_FullName,this.nameStateFlag},codeState:function(){return this.codeStateFlag=this.roleEntity.F_EnCode.length>=2,this.codeStateFlag},allowEditmarkState:function(){return this.allowEditmarkStateFlag=null!=this.roleEntity.F_AllowEdit,this.allowEditmarkStateFlag},allowDeletemarkState:function(){return this.allowDeletemarkStateFlag=null!=this.roleEntity.F_AllowDelete,this.allowDeletemarkStateFlag},enabledmarkState:function(){return this.enabledmarkStateFlag=null!=this.roleEntity.F_EnabledMark,this.enabledmarkStateFlag},invalidParent:function(){return this.parentStateFlag?"":"请选择一个归属机构"},invalidName:function(){return this.nameStateFlag?"":"请输入名称"},invalidCode:function(){return this.codeStateFlag?"":"2位以上的中文或英文"},invalidEdit:function(){return this.allowEditmarkStateFlag?"":"请选择一个选项"},invalidDelete:function(){return this.allowDeletemarkStateFlag?"":"请选择一个选项"},invalidEnable:function(){return this.enabledmarkStateFlag?"":"请选择一个选项"}},mounted:function(){},methods:{handleSubmit:function(){return this.roleModel.title,!!(this.parentStateFlag&&this.nameStateFlag&&this.codeStateFlag&&this.allowEditmarkStateFlag&&this.allowDeletemarkStateFlag&&this.enabledmarkStateFlag)||void 0},updataRoleButton:function(t,e,a){this.roleModel.title="修改岗位",this.roleEntity=JSON.parse(JSON.stringify(t)),this.$root.$emit("bv::show::modal",this.roleModel.id,a)},insertRoleButton:function(t){this.roleEntity.F_OrganizeId="",this.roleEntity.F_FullName="",this.roleEntity.F_Category="",this.roleEntity.F_EnCode="",this.roleEntity.F_AllowEdit=null,this.roleEntity.F_AllowDelete=null,this.roleEntity.F_EnabledMark=null,this.roleEntity.F_CreatorUserId="",this.roleEntity.F_CreatorTime=null,this.roleEntity.F_LastModifyUserId="",this.roleEntity.F_LastModifyTime=null,this.roleEntity.F_Description="",this.roleModel.title="新建岗位",this.$root.$emit("bv::show::modal",this.roleModel.id,t)},insertRole:function(){var t=this;m(this.roleEntity.F_FullName,this.roleEntity.F_OrganizeId).then((function(e){1==e?Object(f["Message"])({message:"该归属机构下已存在此岗位！",type:"warning",duration:5e3}):t.submitRoleForm()}))},updataRole:function(){this.submitRoleForm()},submitRoleForm:function(){var t=this,e={roleEntity:null,keyValue:null};e.roleEntity=this.roleEntity,"修改岗位"==this.roleModel.title&&(e.keyValue=this.roleEntity.F_Id),d(e).then((function(e){"success"==e.state?(t.$nextTick((function(){t.$bvModal.hide(t.roleModel.id)})),t.refresh(),Object(f["Message"])({message:e.message,type:"success",duration:5e3})):Object(f["Message"])({message:"操作失败！",type:"warning",duration:5e3})}))},modalCancel:function(){},modalOk:function(t){t.preventDefault(),this.handleSubmit()&&("修改岗位"==this.roleModel.title?this.showMsgBox("请确认是否修改此岗位！"):this.showMsgBox("请确认是否添加此岗位！"))},showMsgBox:function(t,e,a){var l=this;this.$bvModal.msgBoxConfirm(t,{title:"提示",size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:"确定",cancelTitle:"取消",footerClass:"p-2",hideHeaderClose:!1,centered:!0}).then((function(t){1==t&&("deleteone"==a?l.deleteRole(e):"batchDelete"==a?l.deleteRoles():"新建岗位"==l.roleModel.title?l.insertRole():l.updataRole())})).catch((function(t){}))},deleteRoleButton:function(t){var e="此操作将永久删除该岗位, 是否继续?",a="deleteone";this.showMsgBox(e,t,a)},deleteRolesButton:function(){if(this.itemsSelected.length>0){var t="此操作将永久删除这"+this.itemsSelected.length+"岗位, 是否继续?",e="batchDelete";this.showMsgBox(t,"",e)}else Object(f["Message"])({message:"您未勾选岗位！",type:"warning",duration:5e3})},deleteRole:function(t){var e=this;u(t.F_Id).then((function(t){"success"==t.state&&(e.refresh(),Object(f["Message"])({message:t.message,type:"success",duration:5e3}))}))},deleteRoles:function(){var t=this;c(this.itemsSelected).then((function(e){"success"==e.state&&(console.log("我的测试",t.itemsSelected),t.refresh(),t.itemsSelected=[],Object(f["Message"])({message:e.message,type:"success",duration:5e3}))}))},clearKeyWord:function(){this.pagination.keyword=null,this.searchFlag=!1},refresh:function(){this.itemsSelected=[],this.getList()},userSearch:function(){this.searchFlag=!0,""!=this.pagination.keyword&&null!=this.pagination.keyword?this.getList():(this.searchFlag=!1,Object(f["Message"])({message:"搜索字段不能为空！",type:"warning",duration:5e3}))},onRowSelected:function(t){var e=this.itemsSelected.indexOf(t.F_Id);-1==e?this.itemsSelected.push(t.F_Id):this.itemsSelected.splice(e,1)},judgeValue:function(t){return 1==t?(t="是",t):0==t?(t="否",t):null!=t&&""!=t&&""!=t?t:void(t="空")},parentValue:function(t){for(var e=0;e<this.departmentList.length;e++)if(this.departmentList[e].value==t)return this.departmentList[e].text},nameValue:function(t){for(var e=0;e<this.userList.length;e++)if(this.userList[e].value==t)return this.userList[e].text},setFieldsName:function(){this.fieldsName=new Map([["F_OrganizeId","归属机构"],["F_FullName","岗位名称"],["F_EnCode","岗位编号"],["F_AllowEdit","编辑权限"],["F_AllowDelete","删除权限"],["F_CreatorUserId","创建人员"],["F_CreatorTime","创建时间"],["F_LastModifyUserId","修改人员"],["F_LastModifyTime","修改时间"],["F_EnabledMark","有效"],["F_Description","备注"]])},getOrganizeList:function(){var t=this;r().then((function(e){var a=new Map;t.roleMap=new Map;var l=!0,n=!1,i=void 0;try{for(var s,r=e[Symbol.iterator]();!(l=(s=r.next()).done);l=!0){var o=s.value,u={text:null,value:null};a.set(o.F_Id,o.F_FullName),u.text=o.F_FullName,u.value=o.F_Id,t.departmentList.push(u)}}catch(c){n=!0,i=c}finally{try{l||null==r.return||r.return()}finally{if(n)throw i}}t.roleMap=a,t.getUserList()}))},getUserList:function(){var t=this;o().then((function(e){var a=!0,l=!1,n=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done);a=!0){var r=i.value,o={text:null,value:null};o.text=r.F_RealName,o.value=r.F_Id,t.userList.push(o)}}catch(u){l=!0,n=u}finally{try{a||null==s.return||s.return()}finally{if(l)throw n}}t.getList()}))},getList:function(){var t=this;this.itemsSelected=[],this.items=null;var e=null;this.spinFlag=!0,s(this.pagination).then((function(a){e=a.rows,t.itemsBackUp=a.rows,t.totalRows=a.records,t.spinFlag=!1,t.items=e}))}}},b=h,g=(a("b26d"),a("2877")),p=Object(g["a"])(b,l,n,!1,null,"c65c8e54",null);e["default"]=p.exports},"589e":function(t,e,a){},b26d:function(t,e,a){"use strict";var l=a("589e"),n=a.n(l);n.a},f400:function(t,e,a){"use strict";var l=a("c26b"),n=a("b39a"),i="Map";t.exports=a("e0b8")(i,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=l.getEntry(n(this,i),t);return e&&e.v},set:function(t,e){return l.def(n(this,i),0===t?0:t,e)}},l,!0)}}]);