(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e14dd4b"],{1:function(t,e){},2:function(t,e){},3:function(t,e){},"8c7d":function(t,e,n){"use strict";var a=n("d918"),o=n.n(a);o.a},d818:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-table",{attrs:{busy:t.spinFlag,striped:t.striped,bordered:t.bordered,"show-empty":"",small:"",stacked:"md",items:t.items,fields:t.fields,"sort-by":t.sortBy,"sort-direction":t.sortDirection,"sort-desc":t.sortDesc},on:{"update:sortBy":function(e){t.sortBy=e},"update:sort-by":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:sort-desc":function(e){t.sortDesc=e}},scopedSlots:t._u([{key:"table-busy",fn:function(){},proxy:!0},{key:"cell(index)",fn:function(e){return[n("strong",[t._v(t._s(e.index+1))])]}},{key:"cell(actions)",fn:function(e){return[n("div",{on:{click:function(n){return t.fff(e.item.table_name)}}},[n("import-excel",{on:{getResult:t.getMyExcelData}}),t._v(" "),n("b-button",{staticStyle:{"margin-top":"2.5px","margin-bottom":"2.5px"},attrs:{size:"dm"},on:{click:function(n){return t.downloadMater(e.item.table_name)}}},[t._v("下载数据到Excel ")])],1)]}}])})},o=[],i=(n("34ef"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticStyle:{"margin-right":"10px"}},[n("input",{staticClass:"input-file",attrs:{type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:t.exportData}}),t._v(" "),n("b-button",{staticStyle:{"margin-top":"2.5px","margin-bottom":"2.5px"},attrs:{size:"dm",icon:"el-icon-upload"},on:{click:t.btnClick}},[t._v("上传Excel表格数据")])],1)}),r=[],s=n("1146"),l=n.n(s),c={data:function(){return{}},methods:{btnClick:function(){document.querySelector(".input-file").click()},exportData:function(t){if(t.currentTarget.files.length){var e=this,n=t.currentTarget.files[0],a=new FileReader;FileReader.prototype.readAsBinaryString=function(t){var n,a,o="",i=new FileReader;i.onload=function(){for(var t=new Uint8Array(i.result),r=t.byteLength,s=0;s<r;s++)o+=String.fromCharCode(t[s]);n=l.a.read(o,{type:"binary"}),a=l.a.utils.sheet_to_json(n.Sheets[n.SheetNames[0]]),e.$emit("getResult",a)},i.readAsArrayBuffer(t)},a.readAsBinaryString(n)}}}},u=c,f=(n("8c7d"),n("2877")),d=Object(f["a"])(u,i,r,!1,null,null,null),h=d.exports,m=n("b775");function p(){return Object(m["a"])({url:"/ToolManage/Entity/Get",method:"get"})}function b(){return Object(m["a"])({url:"/ToolManage/Define/Get",method:"get"})}function y(){return Object(m["a"])({url:"/ToolManage/Junked/Get",method:"get"})}function g(){return Object(m["a"])({url:"/ToolManage/Repair/Get",method:"get"})}function _(){return Object(m["a"])({url:"/ToolManage/Whf/Get",method:"get"})}function w(){return Object(m["a"])({url:"/ToolManage/Btwh/Get",method:"get"})}function x(t){return Object(m["a"])({url:"/ToolManage/Define/InsertList",method:"post",data:t})}var k=n("21a6"),v=n.n(k),L={data:function(){return{newdata:[],entityList:[],defineList:[],junkedList:[],repairList:[],whfList:[],btwhList:[],tableflage:null,items:[{table_name:"夹具实体表",data_name:"Tools_Entity"},{table_name:"夹具定义表",data_name:"Tools_Define"},{table_name:"夹具报废记录表",data_name:"Tools_Junked"},{table_name:"夹具报修表",data_name:"Tools_Repair"},{table_name:"夹具领用出入库记录表",data_name:"Tools_WareHouseFlow"},{table_name:"采购入库申请表",data_name:"Tools_ByToWarehouse"}],fields:[{key:"index",label:"序号",class:"text-center"},{key:"table_name",label:"表名"},{key:"data_name",label:"数据库表名"},{key:"actions",label:"操作"}],striped:!0,bordered:!0}},components:{importExcel:h},created:function(){this.getList()},methods:{getMyExcelData:function(t){console.log("wwwwo",t),"夹具定义表"==tname&&x(t).then((function(t){}))},fff:function(t){console.log("fff启动",t),this.tableflage=t},downloadMater:function(t){var e={font:{name:"Verdana",sz:11,color:"FF00FF88"},fill:{fgColor:{rgb:"FFFFAA00"}}},n={bookType:"xlsx",bookSST:!1,type:"binary",defaultCellStyle:e,showGridLines:!1},a={SheetNames:["Sheet1"],Sheets:{},Props:{}},o=null;"夹具实体表"==t&&(o=this.entityList),"夹具定义表"==t&&(o=this.defineList),"夹具报废记录表"==t&&(o=this.junkedList),"夹具报修表"==t&&(o=this.repairList),"夹具领用出入库记录表"==t&&(o=this.whfList),"采购入库申请表"==t&&(o=this.btwhList),a.Sheets["Sheet1"]=l.a.utils.json_to_sheet(o);var i=new Blob([this.s2ab(l.a.write(a,n))],{type:"application/octet-stream"});v.a.saveAs(i,t+".xlsx")},s2ab:function(t){if("undefined"!==typeof ArrayBuffer){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),a=0;a!=t.length;++a)n[a]=255&t.charCodeAt(a);return e}for(var o=new Array(t.length),i=0;i!=t.length;++i)o[i]=255&t.charCodeAt(i);return o},getList:function(){var t=this;p().then((function(e){t.entityList=e})),b().then((function(e){t.defineList=e})),y().then((function(e){t.junkedList=e})),g().then((function(e){t.repairList=e})),_().then((function(e){t.whfList=e})),w().then((function(e){t.btwhList=e}))}}},S=L,T=Object(f["a"])(S,a,o,!1,null,null,null);e["default"]=T.exports},d918:function(t,e,n){}}]);