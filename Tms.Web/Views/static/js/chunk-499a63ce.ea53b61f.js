(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-499a63ce"],{"49bf":function(t,e,a){},e960:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mytable"},[a("b-container",{attrs:{fluid:""}},[a("b-row",[a("b-col",{staticClass:"my-1",attrs:{lg:"6"}},[a("b-form-group",{staticClass:"mb-0",attrs:{label:"字段搜索","label-cols-sm":"3","label-align-sm":"right","label-size":"sm","label-for":"filterInput"}},[a("b-input-group",{attrs:{size:"sm"}},[a("b-form-input",{attrs:{type:"search",placeholder:"名称/编号"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.userSearch()}},model:{value:t.pagination.keyword,callback:function(e){t.$set(t.pagination,"keyword","string"===typeof e?e.trim():e)},expression:"pagination.keyword"}}),t._v(" "),a("b-input-group-append",[t.searchFlag?a("b-button",{on:{click:this.clearKeyWord}},[t._v("\n                   清除\n                 ")]):a("b-button",{on:{click:this.userSearch}},[t._v("\n                   搜索\n                 ")])],1)],1)],1)],1),t._v(" "),a("b-col",{staticClass:"my-1",attrs:{sm:"5",md:"6"}},[a("b-form-group",{staticClass:"mb-0",attrs:{label:"每页数量","label-cols-sm":"6","label-cols-md":"4","label-cols-lg":"3","label-align-sm":"right","label-size":"sm","label-for":"perPageSelect"}},[a("b-form-select",{attrs:{size:"sm",options:t.pageOptions},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),a("b-col",{staticClass:"my-1",attrs:{sm:"5",md:"6"}}),t._v(" "),a("b-col",{staticClass:"my-1",attrs:{sm:"5",md:"6"}},[a("div",{staticClass:"mybutton-user"},[a("b-button",{staticClass:"mybutton-newuser",attrs:{size:"dm",variant:"primary"},on:{click:this.refresh}},[a("i",{staticClass:"el-icon-refresh"}),t._v("  刷新")]),t._v(" "),a("b-button",{staticClass:"mybutton-newuser",attrs:{size:"dm",variant:"primary"},on:{click:function(e){return t.insertOrganizedButton(e.target)}}},[a("i",{staticClass:"el-icon-plus"}),t._v("  新建部门")]),t._v(" "),a("b-button",{attrs:{size:"dm",variant:"primary"},on:{click:function(e){return t.deleteOrganizesButton()}}},[a("i",{staticClass:"el-icon-delete"}),t._v("  删除部门")])],1)])],1),t._v(" "),a("b-table",{attrs:{busy:t.spinFlag,striped:t.striped,bordered:t.bordered,"show-empty":"",small:"",stacked:"md",items:t.items,fields:t.fields,"sort-by":t.sortBy,"sort-direction":t.sortDirection,"sort-desc":t.sortDesc},on:{"update:sortBy":function(e){t.sortBy=e},"update:sort-by":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:sort-desc":function(e){t.sortDesc=e}},scopedSlots:t._u([{key:"table-busy",fn:function(){return[a("div",{staticClass:"text-center text-danger my-2"},[a("b-spinner",{staticClass:"align-middle"}),t._v(" "),a("strong",[t._v("加载中...")])],1)]},proxy:!0},{key:"cell(index)",fn:function(e){return[a("b-form-checkbox",{on:{change:function(a){return t.onRowSelected(e.item)}}},[t._v(" "+t._s(e.index+1)+" ")])]}},{key:"cell(actions)",fn:function(e){return[a("b-button",{staticClass:"mr-1",attrs:{size:"sm",name:"row.item.F_Id"},on:{click:function(a){return t.updataUserButton(e.item,e.index,a.target)}}},[t._v("\n            修改\n          ")]),t._v(" "),a("b-button",{attrs:{size:"sm"},on:{click:e.toggleDetails}},[t._v("\n            "+t._s(e.detailsShowing?"关闭":"显示")+" 详情\n          ")]),t._v(" "),a("b-button",{staticClass:"mr-1",attrs:{size:"sm",name:"row.item.F_Id"},on:{click:function(a){return t.deleteOrganizeButton(e.item)}}},[t._v("\n            删除\n          ")])]}},{key:"row-details",fn:function(e){return[a("b-card",[a("ul",t._l(e.item,(function(e,n){return a("ul",{key:n},[t.fieldsName.get(n)?a("p",[t._v("\n                "+t._s(t.fieldsName.get(n))+" : "+t._s("上级"==t.fieldsName.get(n)?t.parentValue(e):t.judgeValue(e))+"\n              ")]):t._e()])})),0)])]}}])}),t._v(" "),a("div",{staticClass:"myPage",attrs:{align:"center"}},[a("b-col",{staticClass:"my-1",attrs:{sm:"7",md:"6"}},[a("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage,align:"fill",size:"sm"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1),t._v(" "),a("b-modal",{attrs:{id:t.organizeModel.id,title:t.organizeModel.title,okTitle:"确定",cancelTitle:"取消","no-close-on-backdrop":!0,"no-close-on-esc":!0},on:{cancel:t.modalCancel,ok:t.modalOk},scopedSlots:t._u([{key:"modal-header",fn:function(e){return[a("h4",[t._v(t._s(t.organizeModel.title))])]}}])},[t._v(" "),a("form",{ref:"form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[a("b-form-group",{attrs:{description:"",label:"上级:","label-for":"account","invalid-feedback":t.invalidParent,"label-cols-sm":"2",state:t.parentState}},[a("b-form-select",{attrs:{id:"parent",state:t.parentState,options:t.departmentList},model:{value:t.organizeEntity.F_ParentId,callback:function(e){t.$set(t.organizeEntity,"F_ParentId",e)},expression:"organizeEntity.F_ParentId"}})],1),t._v(" "),a("b-form-group",{attrs:{description:"",label:"分类:","label-for":"account","invalid-feedback":t.invalidType,"label-cols-sm":"2",state:t.typeState}},[a("b-form-select",{attrs:{id:"type",state:t.typeState,options:t.typeList},model:{value:t.organizeEntity.F_CategoryId,callback:function(e){t.$set(t.organizeEntity,"F_CategoryId",e)},expression:"organizeEntity.F_CategoryId"}})],1),t._v(" "),a("b-form-group",{attrs:{description:"",label:"名称:","label-for":"name","invalid-feedback":t.invalidName,"label-cols-sm":"2",state:t.nameState}},[a("b-form-input",{attrs:{id:"name",state:t.nameState,trim:""},model:{value:t.organizeEntity.F_FullName,callback:function(e){t.$set(t.organizeEntity,"F_FullName",e)},expression:"organizeEntity.F_FullName"}})],1),t._v(" "),a("b-form-group",{attrs:{description:"",label:"编号:","label-for":"code","invalid-feedback":t.invalidCode,"label-cols-sm":"2",state:t.codeState}},[a("b-form-input",{attrs:{id:"code",state:t.codeState,trim:""},model:{value:t.organizeEntity.F_EnCode,callback:function(e){t.$set(t.organizeEntity,"F_EnCode",e)},expression:"organizeEntity.F_EnCode"}})],1),t._v(" "),a("b-form-group",{attrs:{description:"",label:"负责人:","label-for":"m_name","invalid-feedback":t.invalidManager,"label-cols-sm":"2",state:t.m_nameState}},[a("b-form-input",{attrs:{id:"m_name",state:t.m_nameState,trim:""},model:{value:t.organizeEntity.F_ManagerId,callback:function(e){t.$set(t.organizeEntity,"F_ManagerId",e)},expression:"organizeEntity.F_ManagerId"}})],1),t._v(" "),a("b-form-group",{attrs:{description:"",label:"手机:","label-for":"phone","invalid-feedback":t.invalidMobile,"label-cols-sm":"2",state:t.mobilephoneState}},[a("b-form-input",{attrs:{id:"phone",state:t.mobilephoneState,trim:""},model:{value:t.organizeEntity.F_MobilePhone,callback:function(e){t.$set(t.organizeEntity,"F_MobilePhone",e)},expression:"organizeEntity.F_MobilePhone"}})],1),t._v(" "),a("b-form-group",{attrs:{description:"",label:"微信:","label-for":"WeChat","label-cols-sm":"2"}},[a("b-form-input",{attrs:{id:"WeChat",trim:""},model:{value:t.organizeEntity.F_WeChat,callback:function(e){t.$set(t.organizeEntity,"F_WeChat",e)},expression:"organizeEntity.F_WeChat"}})],1),t._v(" "),a("b-form-group",{attrs:{description:"",label:"电话:","label-for":"tell","label-cols-sm":"2"}},[a("b-form-input",{attrs:{id:"tell",trim:""},model:{value:t.organizeEntity.F_TelePhone,callback:function(e){t.$set(t.organizeEntity,"F_TelePhone",e)},expression:"organizeEntity.F_TelePhone"}})],1),t._v(" "),a("b-form-group",{attrs:{description:"",label:"邮箱:","label-for":"email","invalid-feedback":t.invalidEmail,"label-cols-sm":"2",state:t.emailState}},[a("b-form-input",{attrs:{id:"phone",state:t.emailState,trim:""},model:{value:t.organizeEntity.F_Email,callback:function(e){t.$set(t.organizeEntity,"F_Email",e)},expression:"organizeEntity.F_Email"}})],1),t._v(" "),a("b-form-group",{attrs:{description:"",label:"传真:","label-for":"fax","label-cols-sm":"2"}},[a("b-form-input",{attrs:{id:"fax",trim:""},model:{value:t.organizeEntity.F_Fax,callback:function(e){t.$set(t.organizeEntity,"F_Fax",e)},expression:"organizeEntity.F_Fax"}})],1),t._v(" "),a("b-form-group",{attrs:{description:"",label:"地址:","label-for":"address","label-cols-sm":"2"}},[a("b-form-input",{attrs:{id:"address",trim:""},model:{value:t.organizeEntity.F_Address,callback:function(e){t.$set(t.organizeEntity,"F_Address",e)},expression:"organizeEntity.F_Address"}})],1),t._v(" "),a("b-form-group",{attrs:{"label-for":"enabled","label-cols-sm":"2",label:"有效:","invalid-feedback":t.invalidEnable,state:t.enabledmarkState}},[a("b-form-select",{attrs:{id:"enabled",state:t.enabledmarkState,options:t.enabledList},model:{value:t.organizeEntity.F_EnabledMark,callback:function(e){t.$set(t.organizeEntity,"F_EnabledMark",e)},expression:"organizeEntity.F_EnabledMark"}})],1),t._v(" "),a("b-form-group",{attrs:{description:"",label:"备注:","label-for":"desc","label-cols-sm":"2"}},[a("b-form-input",{attrs:{id:"phone",trim:""},model:{value:t.organizeEntity.F_Description,callback:function(e){t.$set(t.organizeEntity,"F_Description",e)},expression:"organizeEntity.F_Description"}})],1)],1)])],1),t._v(" "),a("el-backtop",{attrs:{target:""}})],1)},i=[],s=(a("ac4d"),a("8a81"),a("ac6a"),a("5df3"),a("f400"),a("b775"));function r(t){return Object(s["a"])({url:"/SystemManage/Organize/GetGridListJson",method:"get",params:t})}function l(t){return Object(s["a"])({url:"/SystemManage/Organize/DeleteForm",method:"get",params:{keyValue:t}})}function o(t){return Object(s["a"])({url:"/SystemManage/Organize/BatchDeleteForm",method:"post",data:t})}function u(t){return Object(s["a"])({url:"/SystemManage/Organize/SubmitForm",method:"post",data:t})}function c(t,e){return Object(s["a"])({url:"/SystemManage/Organize/GetFormByParent",method:"get",params:{full_name:t,parentId:e}})}function d(){return Object(s["a"])({url:"/SystemManage/Organize/GetGridJson",method:"get"})}var m=a("5c96"),g={data:function(){return{userUpdata:null,dutyList:[],roleList:[],departmentList:[],typeList:[{text:"集团",value:"Group"},{text:"公司",value:"Company"},{text:"部门",value:"Department"},{text:"小组",value:"WorkGroup"}],mapLayer:null,mapDepartment:null,enabledList:[{text:"是",value:!0},{text:"否",value:!1}],parentStateFlag:null,typeStateFlag:null,nameStateFlag:null,codeStateFlag:null,m_nameStateFlag:null,mobilephoneStateFlag:null,emailStateFlag:null,enabledmarkStateFlag:null,userF_ParentId:"",organizeEntity:{F_ParentId:"",F_Layers:null,F_CategoryId:"",F_FullName:"",F_EnCode:"",F_ManagerId:"",F_MobilePhone:"",F_WeChat:"",F_TelePhone:null,F_Email:"",F_Fax:"",F_Address:"",F_EnabledMark:null,F_Description:""},userLogOnEntity:{F_UserPassword:""},submitFormFlag:null,groupState:null,searchFlag:!1,totalRows:1,currentPage:1,perPage:10,pageOptions:[5,10,15,20,30],sortBy:null,sortDesc:!1,sortDirection:"asc",spinFlag:!0,pagination:{sord:"desc",page:1,rows:10,sidx:"F_CreatorTime",keyword:null},itemsSelected:[],organizeMap:null,dutyMap:null,roleMap:null,items:[],itemsBackUp:[],fieldsName:null,fields:[{key:"index",label:"序号"},{key:"F_FullName",label:"名称",sortable:!0},{key:"F_EnCode",label:"编号",sortable:!0},{key:"F_CategoryId",label:"分类",sortable:!0},{key:"F_CreatorTime",label:"创建时间",sortable:!0,sortByFormatted:!0,filterByFormatted:!0},{key:"F_EnabledMark",label:"有效",formatter:function(t,e,a){return t?"是":"否"}},{key:"F_Description",label:"备注"},{key:"actions",label:"操作"}],striped:!0,bordered:!0,organizeModel:{id:"info-modal",title:"",content:""}}},watch:{perPage:function(){this.pagination.rows=this.perPage,this.getList()},currentPage:function(){this.pagination.page=this.currentPage,this.getList()},sortBy:function(){this.pagination.sidx=this.sortBy,this.getList(),Object(m["Message"])({message:"查询根据"+this.sortBy+"排序！",type:"success",duration:5e3})},sortDesc:function(){0==this.sortDesc?this.pagination.sord="asc":this.pagination.sord="desc",this.getList(),Object(m["Message"])({message:"查询根据"+this.sortBy+"的"+this.pagination.sord+"排序！",type:"success",duration:5e3})}},created:function(){this.setFieldsName(),this.getTheFullName()},computed:{sortOptions:function(){return this.fields.filter((function(t){return t.sortable})).map((function(t){return{text:t.label,value:t.key}}))},parentState:function(){return this.parentStateFlag=""!=this.organizeEntity.F_ParentId,this.parentStateFlag},typeState:function(){return this.typeStateFlag=""!=this.organizeEntity.F_CategoryId,this.typeStateFlag},nameState:function(){return this.nameStateFlag=""!=this.organizeEntity.F_FullName,this.nameStateFlag},m_nameState:function(){return this.m_nameStateFlag=this.organizeEntity.F_ManagerId.length>=2,this.m_nameStateFlag},codeState:function(){return this.codeStateFlag=this.organizeEntity.F_EnCode.length>=2,this.codeStateFlag},mobilephoneState:function(){var t=/^((13[0-9])|(14[5|7])|(15([0-3]|[5-9]))|(18[0,5-9]))\d{8}$/;return this.mobilephoneStateFlag=t.test(this.organizeEntity.F_MobilePhone),this.mobilephoneStateFlag},emailState:function(){var t=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;return this.emailStateFlag=t.test(this.organizeEntity.F_Email),this.emailStateFlag},enabledmarkState:function(){return this.enabledmarkStateFlag=null!=this.organizeEntity.F_EnabledMark,this.enabledmarkStateFlag},invalidParent:function(){return this.parentStateFlag?"":"请选择一个上级"},invalidType:function(){return this.typeStateFlag?"":"请选择一个分类"},invalidName:function(){return this.nameStateFlag?"":"请输入名称"},invalidCode:function(){return this.codeStateFlag?"":"2位以上的中文或英文"},invalidManager:function(){return this.m_nameStateFlag?"":"2到8位的中文或英文"},invalidMobile:function(){return this.mobilephoneStateFlag?"":"请输入正确的手机号码"},invalidEmail:function(){return this.emailStateFlag?"":"请输入正确的邮箱格式,如：xxx@xxx.xxx"},invalidEnable:function(){return this.enabledmarkStateFlag?"":"请选择一个选项"}},mounted:function(){},methods:{handleSubmit:function(){return this.organizeModel.title,!!(this.parentStateFlag&&this.typeStateFlag&&this.nameStateFlag&&this.codeStateFlag&&this.m_nameStateFlag&&this.mobilephoneStateFlag&&this.emailStateFlag&&this.enabledmarkStateFlag)||void 0},updataUserButton:function(t,e,a){this.organizeModel.title="修改机构",this.organizeEntity=JSON.parse(JSON.stringify(t)),console.log("这是数据：",this.organizeEntity),this.$root.$emit("bv::show::modal",this.organizeModel.id,a)},insertOrganizedButton:function(t){this.organizeEntity.F_ParentId="",this.organizeEntity.F_CategoryId="",this.organizeEntity.F_Layers=null,this.organizeEntity.F_FullName="",this.organizeEntity.F_EnCode="",this.organizeEntity.F_ManagerId="",this.organizeEntity.F_MobilePhone="",this.organizeEntity.F_WeChat="",this.organizeEntity.F_TelePhone=null,this.organizeEntity.F_Email="",this.organizeEntity.F_Fax="",this.organizeEntity.F_Address="",this.organizeEntity.F_EnabledMark=null,this.organizeEntity.F_Description="",this.organizeModel.title="新建机构",this.$root.$emit("bv::show::modal",this.organizeModel.id,t)},insertOrganized:function(){var t=this;c(this.organizeEntity.F_FullName,this.organizeEntity.F_ParentId).then((function(e){1==e?Object(m["Message"])({message:"该上级下已存在此机构！",type:"warning",duration:5e3}):("0"==t.organizeEntity.F_ParentId?t.organizeEntity.F_Layers=1:t.organizeEntity.F_Layers=t.mapLayer.get(t.organizeEntity.F_ParentId)+1,t.submitOrganizeForm())}))},updataUser:function(){this.submitOrganizeForm()},submitOrganizeForm:function(){var t=this,e={organizeEntity:null,keyValue:null};e.organizeEntity=this.organizeEntity,"修改机构"==this.organizeModel.title&&(e.keyValue=this.organizeEntity.F_Id),u(e).then((function(e){"success"==e.state?(t.$nextTick((function(){t.$bvModal.hide(t.organizeModel.id)})),t.refresh(),Object(m["Message"])({message:e.message,type:"success",duration:5e3}),t.getTheFullName()):Object(m["Message"])({message:"操作失败！",type:"warning",duration:5e3})}))},modalCancel:function(){},modalOk:function(t){t.preventDefault(),this.handleSubmit()&&("修改机构"==this.organizeModel.title?this.showMsgBox("请确认是否修改此机构！"):this.showMsgBox("请确认是否添加此机构！"))},showMsgBox:function(t,e,a){var n=this;this.$bvModal.msgBoxConfirm(t,{title:"提示",size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:"确定",cancelTitle:"取消",footerClass:"p-2",hideHeaderClose:!1,centered:!0}).then((function(t){1==t&&("deleteone"==a?(n.deleteOrganize(e),n.departmentList=[]):"batchDelete"==a?(n.deleteOrganizes(),n.departmentList=[]):"新建机构"==n.organizeModel.title?n.insertOrganized():n.updataUser())})).catch((function(t){}))},deleteOrganizeButton:function(t){var e="此操作将永久删除该机构, 是否继续?",a="deleteone";this.showMsgBox(e,t,a)},deleteOrganizesButton:function(){if(this.itemsSelected.length>0){var t="此操作将永久删除这"+this.itemsSelected.length+"机构, 是否继续?",e="batchDelete";this.showMsgBox(t,"",e)}else Object(m["Message"])({message:"您未勾选机构！",type:"warning",duration:5e3})},deleteOrganize:function(t){var e=this;l(t.F_Id).then((function(t){"success"==t.state&&(e.refresh(),e.getTheFullName(),Object(m["Message"])({message:t.message,type:"success",duration:5e3}))}))},deleteOrganizes:function(){var t=this;o(this.itemsSelected).then((function(e){"success"==e.state&&(t.refresh(),t.getTheFullName(),t.itemsSelected=[],Object(m["Message"])({message:e.message,type:"success",duration:5e3}))}))},clearKeyWord:function(){this.pagination.keyword=null,this.searchFlag=!1},refresh:function(){this.itemsSelected=[],this.getList()},userSearch:function(){this.searchFlag=!0,""!=this.pagination.keyword&&null!=this.pagination.keyword?this.getList():(this.searchFlag=!1,Object(m["Message"])({message:"搜索字段不能为空！",type:"warning",duration:5e3}))},onRowSelected:function(t){var e=this.itemsSelected.indexOf(t.F_Id);-1==e?this.itemsSelected.push(t.F_Id):this.itemsSelected.splice(e,1)},judgeValue:function(t){return 1==t?(t="是",t):0==t?(t="否",t):null!=t&&""!=t&&""!=t?t:void(t="空")},parentValue:function(t){for(var e=0;e<this.departmentList.length;e++)if(this.departmentList[e].value==t)return this.departmentList[e].text},setFieldsName:function(){this.fieldsName=new Map([["F_FullName","名称"],["F_EnCode","编号"],["F_CategoryId","分类"],["F_ManagerId","负责人"],["F_MobilePhone","手机"],["F_WeChat","微信"],["F_TelePhone","电话"],["F_Email","邮箱"],["F_Fax","传真"],["F_Address","地址"],["F_CreatorTime","创建时间"],["F_ParentId","上级"],["F_EnabledMark","有效"],["F_Description","备注"]])},getTheFullName:function(){var t=this,e=new Map,a=new Map,n=new Map;d().then((function(i){e.set("0","父节点");var s={text:"父节点",value:"0"};t.departmentList.push(s);var r=!0,l=!1,o=void 0;try{for(var u,c=i[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var d=u.value,m={text:null,value:null};e.set(d.F_Id,d.F_FullName),a.set(d.F_FullName,d.F_Id),n.set(d.F_Id,d.F_Layers),m.text=d.F_FullName,m.value=d.F_Id,t.departmentList.push(m)}}catch(g){l=!0,o=g}finally{try{r||null==c.return||c.return()}finally{if(l)throw o}}t.mapDepartment=a,t.mapLayer=n,t.getList()}))},getList:function(){var t=this;this.itemsSelected=[],this.items=null;var e=null;this.spinFlag=!0,r(this.pagination).then((function(a){e=a.rows,t.itemsBackUp=a.rows,t.totalRows=a.records,t.spinFlag=!1,t.items=e}))}}},b=g,h=(a("f656"),a("2877")),p=Object(h["a"])(b,n,i,!1,null,"1894c4af",null);e["default"]=p.exports},f400:function(t,e,a){"use strict";var n=a("c26b"),i=a("b39a"),s="Map";t.exports=a("e0b8")(s,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=n.getEntry(i(this,s),t);return e&&e.v},set:function(t,e){return n.def(i(this,s),0===t?0:t,e)}},n,!0)},f656:function(t,e,a){"use strict";var n=a("49bf"),i=a.n(n);i.a}}]);