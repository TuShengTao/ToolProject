(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e9ff9c9"],{"52b5":function(t,e,n){"use strict";var s=n("b56f"),a=n.n(s);a.a},"66f4":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mytable"},[n("b-container",{attrs:{fluid:""}},[n("b-row",[n("b-col",{staticClass:"my-1",attrs:{lg:"6"}},[n("b-form-group",{staticClass:"mb-0",attrs:{label:"字段搜索","label-cols-sm":"3","label-align-sm":"right","label-size":"sm","label-for":"filterInput"}},[n("b-input-group",{attrs:{size:"sm"}},[n("b-form-input",{attrs:{type:"search",placeholder:"类型代码/类型名称"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.userSearch()}},model:{value:t.pagination.keyword,callback:function(e){t.$set(t.pagination,"keyword",e)},expression:"pagination.keyword"}}),t._v(" "),n("b-input-group-append",[t.searchFlag?n("b-button",{on:{click:this.clearKeyWord}},[t._v("\n                   清除\n                 ")]):n("b-button",{on:{click:this.userSearch}},[t._v("\n                   搜索\n                 ")])],1)],1)],1)],1),t._v(" "),n("b-col",{staticClass:"my-1",attrs:{sm:"5",md:"6"}},[n("b-form-group",{staticClass:"mb-0",attrs:{label:"每页数量","label-cols-sm":"6","label-cols-md":"4","label-cols-lg":"3","label-align-sm":"right","label-size":"sm","label-for":"perPageSelect"}},[n("b-form-select",{attrs:{size:"sm",options:t.pageOptions},model:{value:t.perPage,callback:function(e){t.perPage=e},expression:"perPage"}})],1)],1),t._v(" "),n("b-col",{staticClass:"my-1",attrs:{sm:"5",md:"6"}}),t._v(" "),n("b-col",{staticClass:"my-1",attrs:{sm:"5",md:"6"}},[n("div",{staticClass:"mybutton-user"},[n("b-button",{staticClass:"mybutton-newuser",attrs:{size:"dm",variant:"primary"},on:{click:this.refresh}},[n("i",{staticClass:"el-icon-refresh"}),t._v("  刷新")]),t._v(" "),n("b-button",{staticClass:"mybutton-newuser",attrs:{size:"dm",variant:"primary"},on:{click:function(e){return t.insertTypeButton(e.target)}}},[n("i",{staticClass:"el-icon-plus"}),t._v("  新建类型")])],1)])],1),t._v(" "),n("b-table",{attrs:{busy:t.spinFlag,striped:t.striped,bordered:t.bordered,"show-empty":"",small:"",stacked:"md",items:t.items,fields:t.fields,"sort-by":t.sortBy,"sort-direction":t.sortDirection,"sort-desc":t.sortDesc},on:{"update:sortBy":function(e){t.sortBy=e},"update:sort-by":function(e){t.sortBy=e},"update:sortDesc":function(e){t.sortDesc=e},"update:sort-desc":function(e){t.sortDesc=e}},scopedSlots:t._u([{key:"table-busy",fn:function(){return[n("div",{staticClass:"text-center text-danger my-2"},[n("b-spinner",{staticClass:"align-middle"}),t._v(" "),n("strong",[t._v("加载中...")])],1)]},proxy:!0},{key:"cell(index)",fn:function(e){return[n("strong",[t._v(t._s(e.index+1)+" ")])]}},{key:"cell(actions)",fn:function(e){return[n("b-button",{staticClass:"mr-1",attrs:{size:"sm",name:"row.item.F_Id"},on:{click:function(n){return t.updataTypeButton(e.item,e.index,n.target)}}},[t._v("\n            编辑\n          ")]),t._v(" "),n("b-button",{staticClass:"mr-1",attrs:{size:"sm",name:"row.item.T_Id"},on:{click:function(n){return t.deleteTypeButton(e.item)}}},[t._v("\n            删除\n          ")])]}},{key:"row-details",fn:function(e){return[n("b-card",[n("ul",t._l(e.item,(function(e,s){return n("ul",{key:s},[t.fieldsName.get(s)?n("p",[t._v("\n                "+t._s(t.fieldsName.get(s))+" : "+t._s(t.judgeValue(e))+"\n              ")]):t._e()])})),0)])]}}])}),t._v(" "),n("div",{staticClass:"myPage",attrs:{align:"center"}},[n("b-col",{staticClass:"my-1",attrs:{sm:"7",md:"6"}},[n("b-pagination",{staticClass:"my-0",attrs:{"total-rows":t.totalRows,"per-page":t.perPage,align:"fill",size:"sm"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1),t._v(" "),n("b-modal",{attrs:{id:t.typeModal.id,title:t.typeModal.title,scrollable:"",okTitle:"确定",cancelTitle:"取消","no-close-on-backdrop":!0,"no-close-on-esc":!0},on:{cancel:t.modalCancel,ok:t.modalOk},scopedSlots:t._u([{key:"modal-header",fn:function(e){return[n("h4",[t._v(t._s(t.typeModal.title))])]}}])},[t._v(" "),n("form",{ref:"form",on:{submit:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[n("b-form-group",{attrs:{description:"",label:"夹具类型:","label-for":"name","label-cols-sm":"2"}},[n("b-form-input",{attrs:{id:"name",trim:""},model:{value:t.typeEntity.T_TypeName,callback:function(e){t.$set(t.typeEntity,"T_TypeName",e)},expression:"typeEntity.T_TypeName"}})],1)],1)])],1),t._v(" "),n("el-backtop",{attrs:{target:""}})],1)},a=[],i=(n("ac4d"),n("8a81"),n("ac6a"),n("5df3"),n("f400"),n("b775"));function o(t){return Object(i["a"])({url:"/ToolManage/Type/GetGridJson",method:"get",params:t})}function r(){return Object(i["a"])({url:"/SystemManage/Organize/GetGridJson",method:"get"})}function l(t){return Object(i["a"])({url:"/ToolManage/Type/GetFormByType",method:"get",params:{code:t}})}function c(t){return Object(i["a"])({url:"/ToolManage/Type/Insert",method:"post",data:t})}function u(t){return Object(i["a"])({url:"/ToolManage/Type/Update",method:"post",data:t})}function d(t){return Object(i["a"])({url:"/ToolManage/Type/DeleteForm",method:"post",params:{keyValue:t}})}var p=n("5c96"),m={data:function(){return{itemsSelected:[],departmentList:[],organizeMap:null,items:[],itemsBackUp:[],fieldsName:null,codeStateFlag:null,departmentStateFlag:null,typeEntity:{T_Id:"",T_TypeName:"",T_DepartmentId:null},submitFormFlag:null,groupState:null,searchFlag:!1,totalRows:1,currentPage:1,perPage:10,pageOptions:[5,10,15,20,30],sortBy:null,sortDesc:!1,sortDirection:"asc",spinFlag:!0,fields:[{key:"index",label:"序号",class:"text-center"},{key:"T_Id",label:"夹具类型代码",sortable:!0,sortDirection:"desc"},{key:"T_TypeName",label:"类型名称",sortable:!0},{key:"actions",label:"操作"}],filter:null,filterOn:[],striped:!0,bordered:!0,typeModal:{id:"info-modal",title:"",content:""},pagination:{sord:"desc",page:1,rows:10,sidx:"T_Id",keyword:null}}},watch:{perPage:function(){this.pagination.rows=this.perPage,this.getList()},currentPage:function(){this.pagination.page=this.currentPage,this.getList()},sortBy:function(){this.pagination.sidx=this.sortBy,this.getList(),Object(p["Message"])({message:"查询根据"+this.sortBy+"排序！",type:"success",duration:5e3})},sortDesc:function(){0==this.sortDesc?this.pagination.sord="asc":this.pagination.sord="desc",this.getList(),Object(p["Message"])({message:"查询根据"+this.sortBy+"的"+this.pagination.sord+"排序！",type:"success",duration:5e3})}},created:function(){this.setFieldsName(),this.getOrganizeList()},computed:{sortOptions:function(){return this.fields.filter((function(t){return t.sortable})).map((function(t){return{text:t.label,value:t.key}}))},codeState:function(){var t=/^[a-zA-Z0-9_-]{4,16}$/;return this.codeStateFlag=t.test(this.typeEntity.T_Code),this.codeStateFlag},invalidCode:function(){return this.codeStateFlag?"":"4到16位(数字,字母,下划线,减号)"}},mounted:function(){},methods:{handleSubmit:function(){return!0},onRowSelected:function(t){var e=this.itemsSelected.indexOf(t.T_Id);-1==e?this.itemsSelected.push(t.T_Id):this.itemsSelected.splice(e,1)},clearKeyWord:function(){this.pagination.keyword=null,this.searchFlag=!1},refresh:function(){this.itemsSelected=[],this.getList()},userSearch:function(){this.searchFlag=!0,""!=this.pagination.keyword&&null!=this.pagination.keyword?this.getList():(this.searchFlag=!1,Object(p["Message"])({message:"搜索字段不能为空！",type:"warning",duration:5e3}))},insertTypeButton:function(t){this.typeEntity.T_Id="",this.typeEntity.T_TypeName="",this.typeEntity.T_DepartmentId=null,this.typeModal.title="新建夹具类型",this.$root.$emit("bv::show::modal",this.typeModal.id,t)},updataTypeButton:function(t,e,n){this.typeModal.title="修改夹具类型",this.typeEntity=JSON.parse(JSON.stringify(t)),this.typeEntity.T_DepartmentId=this.mapDepartment.get(t.T_DepartmentId),this.$root.$emit("bv::show::modal",this.typeModal.id,n)},deleteTypeButton:function(t){var e="此操作将永久删除该实体, 是否继续?",n="deleteone";this.showMsgBox(e,t,n)},insertType:function(){var t=this;l(this.typeEntity.T_Id).then((function(e){if(1==e)Object(p["Message"])({message:"夹具类型已经存在,请重新填写！",type:"warning",duration:5e3});else{var n={typeEntity:null};n.typeEntity=t.typeEntity,c(n).then((function(e){"success"==e.state?(t.$nextTick((function(){t.$bvModal.hide(t.typeModal.id)})),t.refresh(),Object(p["Message"])({message:e.message,type:"success",duration:5e3})):Object(p["Message"])({message:"操作失败！",type:"warning",duration:5e3})}))}}))},updateType:function(){var t=this,e={typeEntity:null,keyValue:null};e.typeEntity=this.typeEntity,e.keyValue=this.typeEntity.T_Id,u(e).then((function(e){"success"==e.state?(t.$nextTick((function(){t.$bvModal.hide(t.typeModal.id)})),t.refresh(),Object(p["Message"])({message:e.message,type:"success",duration:5e3})):Object(p["Message"])({message:"操作失败！",type:"warning",duration:5e3})}))},deleteType:function(t){var e=this;d(t.T_Id).then((function(t){"success"==t.state&&(e.refresh(),Object(p["Message"])({message:t.message,type:"success",duration:5e3}))}))},modalCancel:function(){},modalOk:function(t){t.preventDefault(),this.handleSubmit()&&("修改夹具类型"==this.typeModal.title?this.showMsgBox("请确认是否修改此夹具类型！"):this.showMsgBox("请确认是否添加此夹具类型！"))},showMsgBox:function(t,e,n){var s=this;this.$bvModal.msgBoxConfirm(t,{title:"提示",size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:"确定",cancelTitle:"取消",footerClass:"p-2",hideHeaderClose:!1,centered:!0}).then((function(t){1==t&&("deleteone"==n?s.deleteType(e):"新建夹具类型"==s.typeModal.title?s.insertType():s.updateType())})).catch((function(t){}))},setFieldsName:function(){this.fieldsName=new Map([["T_Id","夹具类型代码"],["T_TypeName","类型名称"],["T_DepartmentId","所属部门"]])},getOrganizeList:function(){var t=this;r().then((function(e){var n=new Map,s=new Map;t.organizeMap=new Map,t.mapDepartment=new Map;var a=!0,i=!1,o=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var c=r.value,u={text:null,value:null};n.set(c.F_Id,c.F_FullName),s.set(c.F_FullName,c.F_Id),u.text=c.F_FullName,u.value=c.F_Id,t.departmentList.push(u)}}catch(d){i=!0,o=d}finally{try{a||null==l.return||l.return()}finally{if(i)throw o}}t.mapDepartment=s,t.organizeMap=n,t.getList()}))},getList:function(){var t=this;this.itemsSelected=[],this.items=null;var e=null;this.spinFlag=!0,o(this.pagination).then((function(n){e=n.rows,t.itemsBackUp=n.rows;for(var s=0;s<e.length;s++)e[s].T_DepartmentId=t.organizeMap.get(e[s].T_DepartmentId);t.totalRows=n.records,t.spinFlag=!1,t.items=e}))},info:function(t,e,n){this.infoModal.title="Row index: ".concat(e),this.infoModal.content=JSON.stringify(t,null,2),this.$root.$emit("bv::show::modal",this.infoModal.id,n)},resetInfoModal:function(){this.infoModal.title="",this.infoModal.content=""}}},y=m,f=(n("52b5"),n("2877")),g=Object(f["a"])(y,s,a,!1,null,"11d64408",null);e["default"]=g.exports},b56f:function(t,e,n){},f400:function(t,e,n){"use strict";var s=n("c26b"),a=n("b39a"),i="Map";t.exports=n("e0b8")(i,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=s.getEntry(a(this,i),t);return e&&e.v},set:function(t,e){return s.def(a(this,i),0===t?0:t,e)}},s,!0)}}]);